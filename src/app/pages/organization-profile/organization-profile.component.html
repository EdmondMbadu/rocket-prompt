<ng-container *ngIf="organizationLoaded(); else loading">
  <div class="min-h-screen bg-white text-slate-900">
    <!-- TOP BAR -->
    <header class="bg-white/95 backdrop-blur-xl border-b-2 border-black/5 shadow-md sticky top-0 z-40">
      <div class="mx-auto max-w-6xl px-4 pb-6 pt-5 sm:px-6 lg:px-8">
        <div class="flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between">
          <!-- Brand -->
          <div class="flex items-center gap-3 text-slate-900">
            <button type="button" (click)="navigateToHomeOrLanding()"
              class="flex items-center gap-3 hover:opacity-80 transition-opacity cursor-pointer">
              <img src="assets/rocket-logo.png" alt="Rocket Prompt Logo" class="h-14 w-auto" />
            </button>
          </div>
        </div>
      </div>
    </header>

    <!-- ORGANIZATION HEADER -->
    <section class="mx-auto max-w-6xl px-4 pt-8 sm:px-6 lg:px-8" *ngIf="organization(); else notFound">
      <!-- Cover Image -->
      <div *ngIf="organization()!.coverImageUrl" 
        class="relative h-64 w-full rounded-2xl overflow-hidden mb-6 border-2 border-slate-200">
        <img [src]="organization()!.coverImageUrl" 
          [alt]="organization()!.name + ' cover image'"
          class="w-full h-full object-cover" />
      </div>
      <div *ngIf="!organization()!.coverImageUrl"
        class="relative h-64 w-full rounded-2xl bg-gradient-to-br from-slate-100 to-slate-200 mb-6 border-2 border-slate-200">
      </div>

      <!-- Organization Info -->
      <div class="flex flex-col sm:flex-row items-start sm:items-center gap-6 mb-8">
        <div class="flex items-center gap-5">
          <div class="relative -mt-16 sm:-mt-20">
            <div *ngIf="organization()!.logoUrl" 
              class="h-32 w-32 rounded-full bg-white border-4 border-white shadow-xl overflow-hidden">
              <img [src]="organization()!.logoUrl" 
                [alt]="organization()!.name"
                class="w-full h-full object-cover" />
            </div>
            <div *ngIf="!organization()!.logoUrl"
              class="h-32 w-32 rounded-full bg-gradient-to-br from-[#DC2626] to-[#B91C1C] flex items-center justify-center text-white text-4xl font-black shadow-xl border-4 border-white">
              {{ getOrganizationInitials(organization()) }}
            </div>
          </div>
          <div>
            <h1 class="text-4xl font-black tracking-tight text-slate-900">{{ organization()!.name }}</h1>
            <p *ngIf="organization()!.username" class="text-base font-semibold text-slate-600 mt-2">
              @{{ organization()!.username }}
            </p>
            <p *ngIf="organization()!.description" class="text-base text-slate-600 mt-3 max-w-2xl">
              {{ organization()!.description }}
            </p>
          </div>
        </div>
        <div class="ml-auto" *ngIf="isViewingOwnOrganization()">
          <button type="button"
            (click)="navigateToEdit()"
            class="inline-flex items-center gap-2 rounded-xl border-2 border-[#DC2626] bg-white px-6 py-3 text-sm font-bold text-[#DC2626] hover:bg-red-50 transition-colors">
            <svg aria-hidden="true" viewBox="0 0 24 24" class="h-4 w-4" fill="none" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
            </svg>
            Edit Organization
          </button>
        </div>
      </div>

      <!-- Placeholder for prompts (to be implemented) -->
      <div class="rounded-2xl border-2 border-dashed border-slate-200 bg-slate-50 p-12 text-center">
        <div class="text-4xl mb-4">üìù</div>
        <p class="text-slate-500">Organization prompts will be displayed here.</p>
        <p class="text-sm text-slate-400 mt-2">This feature is coming soon.</p>
      </div>
    </section>

    <ng-template #notFound>
      <div class="mx-auto max-w-6xl px-4 pt-16 sm:px-6 lg:px-8">
        <div class="rounded-2xl border-2 border-dashed border-slate-200 bg-slate-50 p-12 text-center">
          <div class="text-4xl mb-4">üîç</div>
          <p class="text-xl font-bold text-slate-900 mb-2">Organization not found</p>
          <p class="text-slate-500 mb-6">The organization you're looking for doesn't exist or has been removed.</p>
          <button type="button"
            (click)="router.navigate(['/organizations'])"
            class="inline-flex items-center gap-2 rounded-xl bg-gradient-to-r from-[#DC2626] to-[#B91C1C] text-white px-6 py-3 text-sm font-bold shadow-lg hover:shadow-xl hover:shadow-red-500/40 hover:scale-105 transition-all duration-200">
            Go to Organizations
          </button>
        </div>
      </div>
    </ng-template>
  </div>
</ng-container>

<ng-template #loading>
  <div role="status" aria-live="polite"
    class="fixed inset-0 z-50 flex items-center justify-center bg-white text-slate-900">
    <div class="w-full max-w-sm px-6 py-8 text-center">
      <div class="mx-auto mb-6 h-12 w-12 animate-spin rounded-full border-4 border-slate-200 border-t-[#DC2626]"></div>
      <p class="text-xl font-semibold">Loading‚Ä¶</p>
      <p class="mt-2 text-sm opacity-80">Preparing organization profile</p>
    </div>
  </div>
</ng-template>

