<button
  type="button"
  class="fixed right-4 top-4 z-40 flex h-10 w-10 items-center justify-center rounded-full border border-slate-200 bg-white text-slate-600 shadow-sm transition hover:border-slate-300 hover:bg-slate-100 focus:outline-none focus:ring-2 focus:ring-slate-400/60 sm:hidden"
  aria-label="Open navigation"
  [attr.aria-expanded]="mobileMenuOpen()"
  (click)="toggleMobileMenu()"
>
  <svg viewBox="0 0 24 24" class="h-5 w-5" fill="none" stroke="currentColor" stroke-width="1.8">
    <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16" />
  </svg>
</button>

<ng-container *ngIf="mobileMenuOpen()">
  <div class="fixed inset-0 z-40 sm:hidden">
    <button
      type="button"
      class="absolute inset-0 h-full w-full bg-slate-950/50"
      aria-label="Close navigation"
      (click)="closeMobileMenu()"
    ></button>

    <div class="absolute left-0 top-0 h-full w-64 max-w-[80vw] bg-white shadow-xl">
      <header class="flex items-center justify-between border-b border-slate-200 px-4 py-4">
        <span class="text-base font-semibold text-slate-900">Menu</span>
        <button
          type="button"
          class="flex h-9 w-9 items-center justify-center rounded-full border border-slate-200 text-slate-500 transition hover:border-slate-300 hover:bg-slate-100"
          aria-label="Close navigation"
          (click)="closeMobileMenu()"
        >
          <svg viewBox="0 0 24 24" class="h-5 w-5" fill="none" stroke="currentColor" stroke-width="1.8">
            <path stroke-linecap="round" stroke-linejoin="round" d="M18 6 6 18M6 6l12 12" />
          </svg>
        </button>
      </header>

      <nav class="space-y-1 px-3 py-4">
        <a
          *ngFor="let item of navItems"
          [routerLink]="item.route"
          [routerLinkActiveOptions]="{ exact: item.exact ?? true }"
          routerLinkActive="bg-slate-100 text-slate-900"
          class="flex items-center gap-3 rounded-lg px-3 py-2 text-sm font-medium text-slate-600 transition-colors hover:bg-slate-100 hover:text-slate-900"
          (click)="closeMobileMenu()"
        >
          <span class="flex h-9 w-9 items-center justify-center rounded-md bg-slate-100 text-slate-600">
            <ng-container [ngSwitch]="item.icon">
              <svg
                *ngSwitchCase="'home'"
                viewBox="0 0 24 24"
                class="h-5 w-5"
                fill="none"
                stroke="currentColor"
                stroke-width="1.6"
              >
                <path stroke-linecap="round" stroke-linejoin="round" d="M3 10.5L12 3l9 7.5" />
                <path stroke-linecap="round" stroke-linejoin="round" d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-7" />
              </svg>
              <svg
                *ngSwitchCase="'collections'"
                viewBox="0 0 24 24"
                class="h-5 w-5"
                fill="none"
                stroke="currentColor"
                stroke-width="1.6"
              >
                <rect x="3.5" y="5" width="17" height="14" rx="2.5" />
                <path d="M8 5v-1.5A1.5 1.5 0 0 1 9.5 2h5A1.5 1.5 0 0 1 16 3.5V5" />
                <path d="M8 11h8" stroke-linecap="round" />
                <path d="M8 15h5" stroke-linecap="round" />
              </svg>
              <svg
                *ngSwitchCase="'bookmark'"
                viewBox="0 0 24 24"
                class="h-5 w-5"
                fill="none"
                stroke="currentColor"
                stroke-width="1.6"
              >
                <path
                  d="M6 3h12a1 1 0 0 1 1 1v16.382a.5.5 0 0 1-.79.407L12 17.25l-6.21 3.539a.5.5 0 0 1-.79-.407V4a1 1 0 0 1 1-1z"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
              <span *ngSwitchDefault class="h-5 w-5"></span>
            </ng-container>
          </span>
          <span>{{ item.label }}</span>
        </a>
      </nav>
    </div>
  </div>
</ng-container>

<aside
  class="hidden min-h-screen shrink-0 border-r border-slate-200 bg-white text-slate-700 transition-all duration-200 sm:flex"
  [class.w-56]="!collapsed()"
  [class.w-20]="collapsed()"
>
  <div
    class="flex w-full flex-col px-4 py-6 transition-all duration-200"
    [class.gap-6]="!collapsed()"
    [class.gap-4]="collapsed()"
    [class.items-center]="collapsed()"
    [class.px-3]="collapsed()"
  >
    <header
      class="flex items-center px-2 transition-all duration-200"
      [class.justify-center]="collapsed()"
      [class.px-0]="collapsed()"
    >
      <button
        type="button"
        class="flex h-10 w-10 items-center justify-center rounded-full border border-slate-200 text-slate-600 transition hover:border-slate-300 hover:bg-slate-100"
        aria-label="Toggle menu"
        [attr.aria-expanded]="!collapsed()"
        (click)="toggleCollapsed()"
      >
        <svg viewBox="0 0 24 24" class="h-5 w-5" fill="none" stroke="currentColor" stroke-width="1.8">
          <path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16" />
        </svg>
      </button>
    </header>

    <nav
      class="flex flex-col gap-1 transition-all duration-200"
      [class.items-center]="collapsed()"
      [class.w-full]="!collapsed()"
    >
      <a
        *ngFor="let item of navItems"
        [routerLink]="item.route"
        [routerLinkActiveOptions]="{ exact: item.exact ?? true }"
        routerLinkActive="bg-slate-100 text-slate-900"
        class="flex items-center rounded-lg px-3 py-2 text-sm font-medium text-slate-600 transition-colors hover:bg-slate-100 hover:text-slate-900"
        [class.gap-3]="!collapsed()"
        [class.justify-center]="collapsed()"
        [class.w-full]="!collapsed()"
        [attr.aria-label]="collapsed() ? item.label : null"
      >
        <span
          class="flex h-9 w-9 items-center justify-center rounded-md bg-slate-100 text-slate-600 transition-all duration-200"
          [class.h-10]="collapsed()"
          [class.w-10]="collapsed()"
        >
          <ng-container [ngSwitch]="item.icon">
            <svg
              *ngSwitchCase="'home'"
              viewBox="0 0 24 24"
              class="h-5 w-5"
              fill="none"
              stroke="currentColor"
              stroke-width="1.6"
            >
              <path stroke-linecap="round" stroke-linejoin="round" d="M3 10.5L12 3l9 7.5" />
              <path stroke-linecap="round" stroke-linejoin="round" d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-7" />
            </svg>
            <svg
              *ngSwitchCase="'collections'"
              viewBox="0 0 24 24"
              class="h-5 w-5"
              fill="none"
              stroke="currentColor"
              stroke-width="1.6"
            >
              <rect x="3.5" y="5" width="17" height="14" rx="2.5" />
              <path d="M8 5v-1.5A1.5 1.5 0 0 1 9.5 2h5A1.5 1.5 0 0 1 16 3.5V5" />
              <path d="M8 11h8" stroke-linecap="round" />
              <path d="M8 15h5" stroke-linecap="round" />
            </svg>
            <svg
              *ngSwitchCase="'bookmark'"
              viewBox="0 0 24 24"
              class="h-5 w-5"
              fill="none"
              stroke="currentColor"
              stroke-width="1.6"
            >
              <path
                d="M6 3h12a1 1 0 0 1 1 1v16.382a.5.5 0 0 1-.79.407L12 17.25l-6.21 3.539a.5.5 0 0 1-.79-.407V4a1 1 0 0 1 1-1z"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
            <span *ngSwitchDefault class="h-5 w-5"></span>
          </ng-container>
        </span>
        <span *ngIf="!collapsed()" class="truncate">{{ item.label }}</span>
      </a>
    </nav>
  </div>
</aside>

